{% extends "base.html" %}
{% block content %}
<div class="layout">
  <!-- Left column: input -->
  <aside class="sidebar">
    <div class="input-card">
      <h2>Select Concepts</h2>
      <p class="subtitle">Enter two concepts to discover how they connect.</p>
      
      <form id="query-form">
        <label>First Concept
          <input name="concept_a" placeholder="e.g., Photosynthesis" required>
        </label>

        <div class="link-divider">LINK</div>

        <label>Second Concept
          <input name="concept_b" placeholder="e.g., Supply and Demand" required>
        </label>

        <div class="profile-section">
          <div class="profile-header">
            <h3>Student Profile</h3>
            <button type="button" class="collapse-btn" id="profile-toggle">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </button>
          </div>
          <p class="profile-subtitle">Personalize the explanation.</p>
          
          <div id="profile-content" class="profile-content">
            <label>Knowledge Level
              <select name="knowledge_level">
                <option value="beginner">beginner</option>
                <option value="intermediate" selected>intermediate</option>
                <option value="advanced">advanced</option>
              </select>
            </label>

            <label>Education Level
              <input name="education_level" placeholder="e.g., Undergraduate" />
            </label>

            <label>Education System
              <input name="education_system" placeholder="e.g., IB, US K-12, GCSE" />
            </label>

            <div class="knowledge-sliders">
              <label class="slider-field">
                <span class="slider-label">Prior knowledge of <strong data-concept="a">Concept A</strong></span>
                <input type="range" name="concept_a_knowledge" min="0" max="5" step="1" value="0">
                <span class="slider-value" data-display="concept_a">0</span>
              </label>

              <label class="slider-field">
                <span class="slider-label">Prior knowledge of <strong data-concept="b">Concept B</strong></span>
                <input type="range" name="concept_b_knowledge" min="0" max="5" step="1" value="0">
                <span class="slider-value" data-display="concept_b">0</span>
              </label>
            </div>
          </div>
        </div>

        <button type="submit" class="primary-btn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z"/>
          </svg>
          Find Connections
        </button>
      </form>

      <div class="action-buttons">
        <button type="button" id="random-btn" class="secondary-btn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
          </svg>
          Random Example
        </button>
        <button type="button" id="clear-btn" class="secondary-btn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
          </svg>
          Clear All
        </button>
      </div>
    </div>

    <div id="session-history">
      <h3>History</h3>
      <ul id="history-list"></ul>
    </div>
  </aside>

  <!-- Right column: results -->
  <section class="results-area">
    <div id="progress" class="hidden">
      <div class="progress-header">
        <div class="progress-spinner"></div>
        <div class="progress-text">Preparing agents...</div>
      </div>
      <ul id="progress-steps" class="progress-steps"></ul>
    </div>

    <div id="connection-flow"></div>

    <div id="results">
      <div class="empty-state-main">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z"/>
        </svg>
        <h2>AI-Generated Explanations</h2>
        <p>Your insights will appear here once you find connections.</p>
      </div>

      <div class="explanation-section hidden">
        <h2>Explanations</h2>
        <div id="explanations"></div>
      </div>

      <div class="analogy-section hidden">
        <h2>Analogies</h2>
        <div id="analogies"></div>
      </div>

      <div class="feedback-section hidden">
        <h2>Was this helpful?</h2>
        <p class="feedback-subtitle">Share a quick rating so the system can adapt future answers.</p>
        <form id="feedback-form">
          <input type="hidden" name="connection_id">
          <div class="feedback-grid">
            <label>Rating
              <select name="rating">
                <option value="5">5 - Excellent</option>
                <option value="4" selected>4 - Helpful</option>
                <option value="3">3 - Average</option>
                <option value="2">2 - Confusing</option>
                <option value="1">1 - Not helpful</option>
              </select>
            </label>
            <label>Comments (optional)
              <textarea name="comments" rows="3" placeholder="What should we adjust next time?"></textarea>
            </label>
          </div>
          <button type="submit" class="primary-btn compact">Submit feedback</button>
          <div id="feedback-status" class="feedback-status" aria-live="polite"></div>
        </form>
      </div>
    </div>
  </section>
</div>

{% endblock %}